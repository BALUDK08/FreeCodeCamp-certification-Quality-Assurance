<div class="challenge-instructions"><div><section id="description">
<p>The basic path this kind of authentication will follow in your app is:</p>
<ol>
<li>User clicks a button or link sending them to our route to authenticate using a specific strategy (e.g. GitHub).</li>
<li>Your route calls <code>passport.authenticate('github')</code> which redirects them to GitHub.</li>
<li>The page the user lands on, on GitHub, allows them to login if they aren't already. It then asks them to approve access to their profile from our app.</li>
<li>The user is then returned to our app at a specific callback url with their profile if they are approved.</li>
<li>They are now authenticated, and your app should check if it is a returning profile, or save it in your database if it is not.</li>
</ol>
<p>Strategies with OAuth require you to have at least a <em>Client ID</em> and a <em>Client Secret</em> which is a way for the service to verify who the authentication request is coming from and if it is valid. These are obtained from the site you are trying to implement authentication with, such as GitHub, and are unique to your app--<strong>THEY ARE NOT TO BE SHARED</strong> and should never be uploaded to a public repository or written directly in your code. A common practice is to put them in your <code>.env</code> file and reference them like so: <code>process.env.GITHUB_CLIENT_ID</code>. For this challenge we're going to use the GitHub strategy.</p>
<p>Obtaining your <em>Client ID and Secret</em> from GitHub is done in your account profile settings under 'developer settings', then <a href="https://github.com/settings/developers" rel="noopener noreferrer nofollow" target="_blank">'OAuth applications'</a>. Click 'Register a new application', name your app, paste in the url to your Replit homepage (<strong>Not the project code's url</strong>), and lastly, for the callback url, paste in the same url as the homepage but with <code>/auth/github/callback</code> added on. This is where users will be redirected for us to handle after authenticating on GitHub. Save the returned information as <code>'GITHUB_CLIENT_ID'</code> and <code>'GITHUB_CLIENT_SECRET'</code> in your <code>.env</code> file.</p>
<p>In your <code>routes.js</code> file, add <code>showSocialAuth: true</code> to the homepage route, after <code>showRegistration: true</code>. Now, create 2 routes accepting GET requests: <code>/auth/github</code> and <code>/auth/github/callback</code>. The first should only call passport to authenticate <code>'github'</code>. The second should call passport to authenticate <code>'github'</code> with a failure redirect to <code>/</code>, and then if that is successful redirect to <code>/profile</code> (similar to our last project).</p>
<p>An example of how <code>/auth/github/callback</code> should look is similar to how we handled a normal login:</p>
<pre class="language-js" tabindex="0"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>passport<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token string">'local'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">failureRedirect</span><span class="token operator">:</span> <span class="token string">'/'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/profile'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Submit your page when you think you've got it right. If you're running into errors, you can check out the project up to this point <a href="https://gist.github.com/camperbot/1f7f6f76adb178680246989612bea21e" rel="noopener noreferrer nofollow" target="_blank">https://gist.github.com/camperbot/1f7f6f76adb178680246989612bea21e</a>.</p>
</section></div><hr/></div>